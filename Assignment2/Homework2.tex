% --------------------------------------------------------------
% This is all preamble stuff that you don't have to worry about.
% Head down to where it says "Start here"
% --------------------------------------------------------------
 
\documentclass[12pt]{article}
 
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb}
 
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand\gldec[2]{
\underset{#1}{\overset{#2}{\gtrless}}
}
 
\newenvironment{theorem}[2][Theorem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{lemma}[2][Lemma]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{exercise}[2][Exercise]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{reflection}[2][Reflection]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{proposition}[2][Proposition]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{corollary}[2][Corollary]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
 
\begin{document}
 
% --------------------------------------------------------------
%                         Start here
% --------------------------------------------------------------
 
%\renewcommand{\qedsymbol}{\filledbox}
 
\title{Homework Assignment # 2}
\author{Rushabh Ashok Dharia\\ 
CSCI-B555 Machine Learning} 
\maketitle

\begin{multline*}
    \text{\textbf{Note: }Homework was discussed with Varun Miranda and Bhushan Malgaonkar}
\end{multline*} 
 
\begin{theorem}[Ans]{1}
\begin{align*}
f(x/\alpha) = \alpha^{x}(1-\alpha)^{1-x} \\
\text{Given }\alpha \text{ is selected from a uniform distribution(0,1)}\\
\text{Therefore }f(\alpha) = \frac{1}{1-0} = 1\\
\end{align*}
\begin{align*}
    argmax_{\alpha}(f(\alpha)f(x/\alpha)) &= 1.\prod_{i=1}^{n}\alpha^{x}(1-\alpha)^{1-x}\\
    \text{Taking log}\\
    &= \sum_{i=1}^{n}(x\log(\alpha)+(1-x)\log(1-\alpha))\\
    \text{Taking derivative w.r.t }\alpha \\
    0 &= \frac{1}{\alpha}\sum_{i=1}^{n}x-\frac{1}{1-\alpha}\sum_{i=1}^{n}(1-x) \\
     \frac{1}{\alpha}\sum_{i=1}^{n}x &= \frac{1}{1-\alpha}\sum_{i=1}^{n}(1-x) \\
     \sum_{i=1}^{n}x - \alpha\sum_{i=1}^{n}x &= N\alpha - \alpha\sum_{i=1}^{n}x \\
     \hat{\alpha}_{MAP} &= \frac{1}{N}\sum_{i=1}^{n}x = \bar{x}
\end{align*}
\end{theorem}
\pagebreak
\begin{theorem}[Ans]{2}
\begin{align*}
argmax_{\theta}\prod_{i=0}^{n}\theta e^{-\theta x} \\
\text{Taking log} \\
\sum_{i=0}^{n}\log{\theta} - \theta x \\
\text{Taking derivative w.r.t.} \theta \\ 
\sum_{i=0}^{n}(\frac{1}{\theta}-x_{i}) &= 0\\
\frac{n}{\theta} &= \sum_{i=0}^{n}x_{i}\\
\hat{\theta}_{MLE} &= \frac{1}{\bar{x}}
\end{align*}
\end{theorem}
\begin{theorem}[Ans]{3}
\begin{proof}[a)]
\begin{align*}
\text{For H0,}\\
f_{X}(x) &= f_{N}(\frac{x+s}{a})\\
\text{For H1,}\\
f_{X}(x) &= f_{N}(\frac{x-s}{b})\\
f_{N}(\frac{x+s}{a}) & \gldec{H1}{H0} f_{N}(\frac{x-s}{b})\\
\text{Since }a&=b\\
f_{N}(\frac{x+s}{a}) & \gldec{H1}{H0} f_{N}(\frac{x-s}{a})\\
\frac{1}{\pi (1+(\frac{x+s}{a})^{2})} & \gldec{H1}{H0} \frac{1}{\pi (1+(\frac{x-s}{a})^{2})}\\
1+(\frac{x-s}{a})^2 & \gldec{H1}{H0} 1 + (\frac{x+s}{a})^{2}\\
x^{2}-2xs+s^{2} & \gldec{H1}{H0} x^{2}+2xs+s^{2} \\
0 \gldec{H1}{H0} 4xs\\
\text{Since s$>$0, s is positive}\\
0 \gldec{H1}{H0} x
\end{align*}
\end{proof}
\pagebreak
\begin{proof}[b)] 
\begin{align*}
r(\hat{y} &= \int_{H0}f(x|y=H1).P(y=H1)dx + \int_{H1}f(x|y=H0).P(y=H0)dx\\
&\text{Since priors are equal }P(y=H1) = P(y=H0) =\frac{1}{2}\\
r(\hat{y} &= \frac{1}{2}\int_{H0}f(x|y=H1)dx+ \int_{H1}f(x|y=H0)dx\\
&= \frac{1}{2} \int_{-\infty}^{0}f_{N}(\frac{x+s}{a}) + \frac{1}{2} \int_{0}^{\infty}f_{N}(\frac{x-s}{b})\\
&= \frac{1}{2}\int_{-\infty}^{0}\frac{1}{\pi (1+(\frac{x+s}{a})^{2})} +  \frac{1}{2}\int_{0}^{\infty}\frac{1}{\pi (1+(\frac{x-s}{b})^{2})}\\
&= \frac{1}{2\pi}\int_{-\infty}^{0}\frac{1}{1+(\frac{x+s}{a})^{2}} + \frac{1}{2\pi}\int_{0}^{\infty}\frac{1}{1+(\frac{x-s}{b})^{2}}\\
\text{put }t &= \frac{x+s}{a} \text{ and }u = \frac{x-s}{b}  \\
\text{When }x&=-\infty\text{,  } t = -\infty\text{. When } x=0 \text{,  }t=\frac{s}{a}\\
\text{When }x&=0\text{,  } u = \frac{-s}{b}\text{. When } x=\infty \text{,  }u=\infty\\
r(\hat{y}&=\frac{1}{2\pi}\int_{-\infty}^{s/a}\frac{1}{1+t^{2}}dt + \frac{1}{2\pi}\int_{-s/b}^{\infty}\frac{1}{1+u^{2}}du\\
&=\frac{1}{2\pi}(\tan^{-1}(\frac{s}{a})+\frac{\pi}{2} +\frac{\pi}{2} - \tan^{-1}(\frac{-s}{b}) )\\
&= \frac{1}{2}+\frac{1}{2\pi}(\tan^{-1}(\frac{s}{a})- \tan^{-1}(\frac{-s}{b}))
\end{align*}
\end{proof}
\end{theorem}
\pagebreak
\begin{theorem}[Ans]{4}
\begin{proof}[a)]
\begin{align*}
f_{Y|X}(y|x) &= \frac{f_{X|Y}(x|y).f_{Y}(y)}{f_{X}(x)}\\
f_{Y}(y) &= \alpha e^{-y\alpha}\\
f_{X}(x) &= \int_{0}^{\infty}f_{X|Y}(x|y).f_{Y}(y)dy\\
&= \int_{0}^{\infty} ye^{-yx}.\alpha e^{-y\alpha} dy\\
&= \alpha \int_{0}^{\infty}ye^{-y(x+\alpha)}dy\\
&\text{Using Integration by parts and LIATE Rule}\\
&= \alpha(y\int e^{-y(x+\alpha)})dy - \int (\frac{d(y)}{dy}\int e^{-y(x+\alpha)})dy)dy)\\
&= \alpha[\frac{-ye^{-y(x+\alpha)}}{x+a}-\frac{e^{-y(x+\alpha)}}{(x+\alpha)^{2}}]_{0}^{\infty}\\
&= \alpha[\frac{-e^{-y(x+\alpha)}}{x+a}(y+\frac{1}{x+\alpha})]_{0}^{\infty}\\
&= \alpha[\frac{e^{-y(x+\alpha)}}{x+a}(y+\frac{1}{x+\alpha})]_{\infty}^{0}\\
&= \alpha[\frac{1}{x+\alpha}(0+\frac{1}{x+\alpha})-0]\\
&= \frac{\alpha}{(x+\alpha)^{2}}\\
f_{Y|X}(y|x) &= \frac{ye^{-yx}\alpha e^{-y\alpha}}{\frac{\alpha}{(x+\alpha)^{2}}}\\
&= (x+\alpha)^2.y.e^{-y(x+\alpha)}
\end{align*}
\end{proof}
\begin{proof}[b)]
\begin{align*}
\end{align*}
\end{proof}
\begin{proof}[c)]
\begin{align*}
\end{align*}
\end{proof}
\end{theorem}
\pagebreak
\begin{theorem}[Ans]{5}
\begin{proof}[a)]
\begin{align*}
P(S=1|V=1) &= P(S=1) \text{ (Since S is independent of V)}\\
P(S=1) &= P(S=1|G=0).P(G=0)+P(S=1|G=1).P(G=1)\\
&= (1-\gamma)\alpha+(1-\beta)(1-\alpha)
\end{align*}
\end{proof}
\begin{proof}[b)]
P(S=1|V=0)  &= P(S=1) \text{ (Since S is independent of V)}\\
&= P(S=1|V=1)\\
\text{Explanation: S is independent of V. Hence value of V doesn't affect S}
\begin{align*}
\end{align*}
\end{proof}
\end{theorem}
\pagebreak
\begin{theorem}[Ans]{6}
\begin{proof}[a)]
\begin{align*}
P(X_{2} = salmon) &= P(X_{1}=Winter).P(X_{2} = salmon|X_{1}=Winter) + \\
& P(X_{1}=Autumn).P(X_{2} = salmon|X_{1}=Autumn) \\
&= 0.5*0.9+0.5*0.8 \\ 
&= 0.85\\
P(X_{2} = seabass) &= P(X_{1}=Winter).P(X_{2} = seabass|X_{1}=Winter) + \\
& P(X_{1}=Autumn).P(X_{2} = seabass|X_{1}=Autumn) \\
&= 0.5*0.1+0.5*0.2 \\ 
&= 0.15
\end{align*}
\end{proof}
\begin{proof}[b)]
\begin{align*}
P(Winter) &= P(X_{1} = Winter)*P(X_{2} = salmon|X_{1}=Winter)*P(X_{3}=Dark|X_{2} = salmon)\\
&*P(X_{4}=Wide|X_{2} = salmon)+P(X_{1} = Winter)*P(X_{2} = seabass|X_{1}=Winter)\\
&*P(X_{3}=Dark|X_{2} = seabass)*P(X_{4}=Wide|X_{2} = seasbass)\\
&= 0.25(0.9*0.34*0.4+0.1*0.1*0.95)\\
&=0.0323\\
P(Spring) &= P(X_{1} = Spring)*P(X_{2} = salmon|X_{1}=Spring)*P(X_{3}=Dark|X_{2} = salmon)\\
&*P(X_{4}=Wide|X_{2} = salmon)+P(X_{1} = Spring)*P(X_{2} = seabass|X_{1}=Spring)\\
&*P(X_{3}=Dark|X_{2} = seabass)*P(X_{4}=Wide|X_{2} = seasbass)\\
&= 0.25(0.3*0.34*0.4+0.7*0.1*0.95)\\
&=0.0268\\
P(Summer) &= P(X_{1} = Summer)*P(X_{2} = salmon|X_{1}=Summer)*P(X_{3}=Dark|X_{2} = salmon)\\
&*P(X_{4}=Wide|X_{2} = salmon)+P(X_{1} = Summer)*P(X_{2} = seabass|X_{1}=Summer)\\
&*P(X_{3}=Dark|X_{2} = seabass)*P(X_{4}=Wide|X_{2} = seasbass)\\
&= 0.25(0.4*0.34*0.4+0.6*0.1*0.95)\\
&=0.02785\\
P(Autumn) &= P(X_{1} = Autumn)*P(X_{2} = salmon|X_{1}=Autumn)*P(X_{3}=Dark|X_{2} = salmon)\\
&*P(X_{4}=Wide|X_{2} = salmon)+P(X_{1} = Autumn)*P(X_{2} = seabass|X_{1}=Autumn)\\
&*P(X_{3}=Dark|X_{2} = seabass)*P(X_{4}=Wide|X_{2} = seasbass)\\
&= 0.25(0.8*0.34*0.4+0.2*0.1*0.95)\\
&=0.03195\\
&\text{It is most likely to be winter}
\end{align*}
\end{proof}
\end{theorem}
\pagebreak
\begin{theorem}[Ans]{7}
\end{theorem}
\begin{theorem}[Ans]{8}
\begin{proof}[b)]
\begin{align*}

\end{align*}
\end{proof}
\end{theorem}
% --------------------------------------------------------------
%     You don't have to mess with anything below this line.
% --------------------------------------------------------------
 
\end{document}